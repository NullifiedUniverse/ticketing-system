/*! For license information please see 643.494229c2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[643],{1643:(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});var a=s(5043),l=s(6089),r=s(1200),n=s(2555),i=s(3986);const c=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const x=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],h=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:l=24,strokeWidth:r=2,absoluteStrokeWidth:c,className:h="",children:m,iconNode:p}=e,u=(0,i.A)(e,x);return(0,a.createElement)("svg",(0,n.A)((0,n.A)((0,n.A)({ref:t},d),{},{width:l,height:l,stroke:s,strokeWidth:c?24*Number(r)/Number(l):r,className:o("lucide",h)},!m&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"}),u),[...p.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])}),m=["className"],p=(e,t)=>{const s=(0,a.forwardRef)((s,l)=>{let{className:r}=s,d=(0,i.A)(s,m);return(0,a.createElement)(h,(0,n.A)({ref:l,iconNode:t,className:o("lucide-".concat((x=c(e),x.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),r)},d));var x});return s.displayName=c(e),s},u=p("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),g=p("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),b=p("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),f=p("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),y=p("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),v=p("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),j=p("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),N=p("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),w=p("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),k=["MacBook Pro M3","iPhone 15 Pro","Sony WH-1000XM5","$500 Amazon Card","Keychron Q1 Pro"];var z=s(579);const C=e=>{let{onUploadComplete:t}=e;const[s,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),c=(0,a.useRef)(null);return(0,z.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-slate-700",children:[(0,z.jsx)("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Upload Prize Image"}),(0,z.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,z.jsx)("input",{type:"file",ref:c,accept:"image/*",onChange:e=>{const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=e=>{i(e.target.result)},s.readAsDataURL(t)},className:"hidden",id:"prize-image-upload"}),(0,z.jsx)("label",{htmlFor:"prize-image-upload",className:"cursor-pointer w-24 h-24 bg-slate-900 border border-slate-600 border-dashed rounded-lg flex items-center justify-center hover:bg-slate-800 transition-colors",children:n?(0,z.jsx)("img",{src:n,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}):(0,z.jsx)("span",{className:"text-2xl text-slate-500",children:"+"})}),(0,z.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,z.jsx)("p",{className:"text-xs text-slate-500",children:'Select an image to use as the "Meteor" for the next prize.'}),(0,z.jsx)("button",{onClick:async()=>{var e;const s=null===(e=c.current)||void 0===e?void 0:e.files[0];if(s){l(!0);try{const e=await(0,r.fz)(s);l(!1),i(null),c.current.value="",t&&t(e),alert("Image Uploaded Successfully!")}catch(a){console.error("Upload Error Details:",a),a.message&&a.message.includes("non-JSON")?alert("Upload Failed: Server returned an error (likely 404 Not Found or 500 Internal Error). Please ensure the backend is running and you have restarted it to apply the new routes."):alert("Upload Failed: "+a.message),l(!1)}}},disabled:!n||s,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-xs font-bold rounded-lg transition-colors",children:s?"Uploading...":"Upload & Queue"})]})]})]})},M="celestial_raffle_sync_v3",A=()=>{var e,t;const{selectedEvent:s,loading:n}=(0,l._)(),[i,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1),[x,h]=(0,a.useState)(k.join("\n")),[m,p]=(0,a.useState)(""),[A,S]=(0,a.useState)(!1),[R,P]=(0,a.useState)(!1),U=(0,a.useCallback)(async()=>{if(s)try{const e=await(0,r.My)(s.id);c(e)}catch(e){console.error(e)}},[s]);(0,a.useEffect)(()=>{U();const e=setInterval(U,2e3);return()=>clearInterval(e)},[U]);return n?(0,z.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center text-cyan-400 font-mono",children:(0,z.jsx)("div",{className:"animate-pulse",children:"LOADING CONTROL CONSOLE..."})}):s?(0,z.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-100 p-8 font-sans",children:(0,z.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent",children:"Raffle Control Center"}),(0,z.jsxs)("p",{className:"text-slate-400",children:["Event: ",s.name]})]}),(0,z.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,z.jsxs)("button",{onClick:()=>{window.open("#raffle-display","RaffleDisplay","width=1920,height=1080")},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm font-bold text-cyan-400 border border-slate-700 transition-colors",children:[(0,z.jsx)(u,{size:16})," Open Display"]}),(0,z.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ".concat("IDLE"===(null===i||void 0===i?void 0:i.status)?"bg-slate-700 text-slate-300":"DRAWING"===(null===i||void 0===i?void 0:i.status)?"bg-blue-600/20 text-blue-400 animate-pulse":"bg-green-600/20 text-green-400"),children:["Status: ",(null===i||void 0===i?void 0:i.status)||"Loading..."]})]})]}),(0,z.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,z.jsxs)("div",{className:"bg-slate-800/50 p-6 rounded-2xl border border-slate-700",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-cyan-400",children:[(0,z.jsx)(g,{size:20}),(0,z.jsx)("h3",{className:"font-bold uppercase tracking-wider text-xs",children:"Eligible Candidates"})]}),(0,z.jsx)("p",{className:"text-4xl font-black",children:(null===i||void 0===i?void 0:i.poolSize)||0}),(0,z.jsxs)("button",{onClick:async()=>{if(s){d(!0);try{const e=await(0,r.vu)(s.id);p(e.message),await U()}catch(e){p("Sync Failed: "+e.message)}d(!1)}},disabled:o,className:"mt-4 text-xs flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[(0,z.jsx)(b,{size:12,className:o?"animate-spin":""})," Sync with Check-ins"]})]}),(0,z.jsxs)("div",{className:"bg-slate-800/50 p-6 rounded-2xl border border-slate-700",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-amber-400",children:[(0,z.jsx)(f,{size:20}),(0,z.jsx)("h3",{className:"font-bold uppercase tracking-wider text-xs",children:"Up Next"})]}),(0,z.jsx)("div",{className:"mt-2",children:null!==i&&void 0!==i&&null!==(e=i.prizes)&&void 0!==e&&e[0]?(0,z.jsxs)(z.Fragment,{children:[i.prizes[0].title&&(0,z.jsx)("p",{className:"text-xs font-bold text-amber-500/80 tracking-widest uppercase mb-1",children:i.prizes[0].title}),(0,z.jsx)("p",{className:"text-2xl font-black text-white truncate leading-tight",children:i.prizes[0].name||i.prizes[0]}),(0,z.jsxs)("p",{className:"text-xs text-slate-500 mt-2",children:["+ ",Math.max(0,((null===i||void 0===i?void 0:i.prizeCount)||0)-1)," more in queue"]})]}):(0,z.jsx)("p",{className:"text-slate-500 italic",children:"Queue Empty"})})]}),(0,z.jsxs)("div",{className:"bg-slate-800/50 p-6 rounded-2xl border border-slate-700",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-purple-400",children:[(0,z.jsx)(y,{size:20}),(0,z.jsx)("h3",{className:"font-bold uppercase tracking-wider text-xs",children:"Last Winner"})]}),(0,z.jsx)("div",{className:"mt-1",children:null!==i&&void 0!==i&&i.winner?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{className:"text-xl font-bold truncate",children:i.winner.name}),(0,z.jsx)("p",{className:"text-sm text-slate-500 font-mono",children:i.winner.maskedId}),(0,z.jsx)("p",{className:"text-xs text-amber-400 mt-1",children:(null===(t=i.currentPrize)||void 0===t?void 0:t.name)||i.currentPrize})]}):(0,z.jsx)("p",{className:"text-slate-500 italic",children:"No winner yet"})})]})]}),(0,z.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,z.jsxs)("div",{className:"space-y-4",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsx)("h3",{className:"font-bold text-slate-300",children:"Prize Queue"}),(0,z.jsxs)("div",{className:"flex gap-2",children:[(0,z.jsxs)("button",{onClick:()=>S(!A),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded-lg text-xs font-bold transition-colors border border-slate-700",title:"Upload Prize Image",children:[(0,z.jsx)(v,{size:14})," ",A?"Hide Upload":"Add Image"]}),(0,z.jsxs)("button",{onClick:async()=>{if(s){d(!0);try{const e=x.split("\n").filter(e=>e.trim().length>0).map(e=>{const t=e.split("|").map(e=>e.trim());let s=null;const a=t[t.length-1];/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(a)&&(s=t.pop());let l="",r="";return t.length>=2?(l=t[0],r=t.slice(1).join(" ")):1===t.length&&(r=t[0],l="CONGRATULATIONS"),s||"CONGRATULATIONS"!==l?{title:l,name:r,image:s}:r});await(0,r.Jr)(s.id,e),p("Updated ".concat(e.length," prizes.")),await U()}catch(e){p("Update Failed: "+e.message)}d(!1)}},disabled:o,className:"flex items-center gap-2 px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded-lg text-xs font-bold transition-colors",children:[(0,z.jsx)(j,{size:14})," Update Queue"]})]})]}),A&&(0,z.jsx)(C,{onUploadComplete:e=>{h(t=>{const s=t.split("\n");return s.length>0&&""!==s[s.length-1].trim()&&!s[s.length-1].includes("|")?(s[s.length-1]="".concat(s[s.length-1]," | ").concat(e),s.join("\n")):t+"\nGrand Prize | New Item | ".concat(e)})}}),(0,z.jsx)("textarea",{value:x,onChange:e=>h(e.target.value),className:"w-full h-64 bg-slate-950 border border-slate-800 rounded-xl p-4 font-mono text-sm text-slate-300 focus:outline-none focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 transition-all resize-none",placeholder:"Enter prizes, one per line.\nFormats:\n- Prize Name\n- Prize Name | image.png\n- Prize Title | Prize Name | image.png"}),(0,z.jsxs)("div",{className:"bg-slate-800/50 p-3 rounded-lg border border-slate-700 text-xs text-slate-400 space-y-1",children:[(0,z.jsx)("p",{className:"font-bold text-slate-300 mb-1",children:"\ud83d\udcdd Prize Format Guide:"}),(0,z.jsxs)("ul",{className:"list-disc list-inside space-y-0.5",children:[(0,z.jsxs)("li",{children:["Simple: ",(0,z.jsx)("code",{className:"bg-slate-900 px-1 rounded text-cyan-400",children:"Prize Name"})]}),(0,z.jsxs)("li",{children:["With Image: ",(0,z.jsx)("code",{className:"bg-slate-900 px-1 rounded text-cyan-400",children:"Prize Name | image.png"})]}),(0,z.jsxs)("li",{children:["With Title: ",(0,z.jsx)("code",{className:"bg-slate-900 px-1 rounded text-cyan-400",children:"GRAND PRIZE | iPhone 15 | phone.png"})]})]}),(0,z.jsx)("p",{className:"mt-2 opacity-75",children:"Upload an image first, then its filename will be auto-appended."})]})]}),(0,z.jsx)("div",{className:"space-y-6",children:(0,z.jsxs)("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-8 flex flex-col items-center justify-center gap-6 h-full shadow-2xl relative overflow-hidden group",children:[(0,z.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-blue-600/5 pointer-events-none"}),(0,z.jsx)("button",{onClick:async()=>{if(s){d(!0),P(!0);try{const e=await(0,r.ah)(s.id);p("Winner: ".concat(e.winner.name));const t=new BroadcastChannel(M);t.postMessage({type:"START_DRAW",winner:e.winner,prize:e.prize}),t.close(),await U(),setTimeout(()=>{P(!1)},8e3)}catch(e){p("Draw Failed: "+e.message),P(!1)}d(!1)}},disabled:o||0===(null===i||void 0===i?void 0:i.poolSize)||R,className:"relative w-48 h-48 rounded-full text-white shadow-2xl transition-all flex flex-col items-center justify-center gap-2 group-disabled:opacity-50 group-disabled:cursor-not-allowed ".concat(R?"bg-slate-700 cursor-wait":null!==i&&void 0!==i&&i.winner?"bg-gradient-to-br from-purple-500 to-pink-600 hover:shadow-purple-500/50":"bg-gradient-to-br from-cyan-500 to-blue-600 hover:shadow-cyan-500/50"),children:R?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(b,{size:48,className:"animate-spin"}),(0,z.jsx)("span",{className:"font-black tracking-widest text-lg",children:"ROLLING"})]}):null!==i&&void 0!==i&&i.winner?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(N,{size:48,className:"fill-current ml-2"}),(0,z.jsx)("span",{className:"font-black tracking-widest text-lg",children:"NEXT"})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(N,{size:48,className:"fill-current ml-2"}),(0,z.jsx)("span",{className:"font-black tracking-widest text-lg",children:"START"})]})}),(0,z.jsx)("div",{className:"flex gap-4 z-10",children:(0,z.jsxs)("button",{onClick:async()=>{if(s&&window.confirm("Reset raffle state? This will clear the current winner display.")){d(!0);try{await(0,r.mh)(s.id);const e=new BroadcastChannel(M);e.postMessage({type:"RESET"}),e.close(),p("Raffle Reset."),await U()}catch(e){p("Reset Failed: "+e.message)}d(!1)}},disabled:o,className:"flex items-center gap-2 px-6 py-3 bg-slate-800 hover:bg-slate-700 rounded-xl font-bold text-slate-400 hover:text-white transition-colors border border-slate-700",children:[(0,z.jsx)(w,{size:18})," Reset"]})}),m&&(0,z.jsx)("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-cyan-400 font-mono animate-pulse",children:m})]})})]})]})}):(0,z.jsxs)("div",{className:"min-h-screen bg-slate-900 flex flex-col items-center justify-center text-slate-400 p-8 text-center",children:[(0,z.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"No Event Selected"}),(0,z.jsx)("p",{children:"Please select an event from the dashboard sidebar to access Raffle Control."}),(0,z.jsx)("button",{onClick:()=>window.location.hash="#dashboard",className:"mt-6 px-6 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm font-bold text-white transition-colors border border-slate-700",children:"Back to Dashboard"})]})}}}]);
//# sourceMappingURL=643.494229c2.chunk.js.map